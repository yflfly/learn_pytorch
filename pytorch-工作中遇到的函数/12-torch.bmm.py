# coding:utf-8
import torch

'''
函数作用
计算两个tensor的矩阵乘法，torch.bmm(a,b),tensor a 的size为(b,h,w),tensor b的size为(b,w,h),
注意两个tensor的维度必须为3.
'''
a = torch.randn((2, 3, 5))
b = torch.reshape(a, (2, 5, 3))
print('---------------a--------------')
print(a)
print('---------------b--------------')
print(b)
c = torch.bmm(a, b)
print('---------------c--------------')
print(c)
print(c.size())

'''
输出结果如下所示：
---------------a--------------
tensor([[[-0.1812, -0.4132,  0.5143, -0.2225,  0.1773],
         [ 0.2935,  0.3682, -1.2605,  1.6545,  0.5369],
         [-2.2016,  1.2037,  0.8912,  0.6055, -1.5207]],

        [[-2.3204, -0.3616,  1.0910,  0.1761, -0.6081],
         [-0.4044, -0.6838,  0.8750,  1.1150,  1.6379],
         [-0.2548, -1.4007,  0.2819,  1.3114, -0.0975]]])
---------------b--------------
tensor([[[-0.1812, -0.4132,  0.5143],
         [-0.2225,  0.1773,  0.2935],
         [ 0.3682, -1.2605,  1.6545],
         [ 0.5369, -2.2016,  1.2037],
         [ 0.8912,  0.6055, -1.5207]],

        [[-2.3204, -0.3616,  1.0910],
         [ 0.1761, -0.6081, -0.4044],
         [-0.6838,  0.8750,  1.1150],
         [ 1.6379, -0.2548, -1.4007],
         [ 0.2819,  1.3114, -0.0975]]])
---------------c--------------
tensor([[[ 0.3527, -0.0494,  0.0991],
         [ 0.7675, -1.7846, -0.6515],
         [-0.5711, -2.2541,  3.7370]],

        [[ 4.6917,  1.1713, -1.3562],
         [ 2.5077,  3.1915, -0.9106],
         [ 2.2723,  0.7286, -1.2247]]])
torch.Size([2, 3, 3])


'''